<html>

<head>
  <script type="text/javascript" src="phaser.min.js"></script>
  <title>DoctorDash - Game</title>
</head>

<body>
  <script>

  var cursors;
  var velocity = 0;

    var game = new Phaser.Game(1000, 1000, Phaser.AUTO, 'main_game', {
      preload: preload,
      create: create,
      update: update
    });

    function preload() {
      this.game.load.spritesheet('track', 'Images/Background-Track.png');
      console.log("Map loaded");
      this.game.load.spritesheet('car', 'Images/Car.png');
    }

    function create() {
      game.physics.startSystem(Phaser.Physics.P2JS);
      var track = game.add.sprite(0, 0, 'track');
      car = game.add.sprite(600, 100, 'car');
      game.physics.p2.enable(car);
      car.body.angle = 0;
      cursors = game.input.keyboard.createCursorKeys();
    }

    function update() {

      if (cursors.up.isDown && velocity <= 400) {
        velocity += 5;
      } else {
        if (velocity >= 5)
          velocity -= 10;
      }

      //if (cursors.down.isDown && velocity >= 0 && velocity <= -200) {
      //  velocity -= 5;
      //}else {
      //  velocity = 0;
      //}

      car.body.velocity.x = velocity * Math.cos((car.angle - 90) * 0.01745);
      car.body.velocity.y = velocity * Math.sin((car.angle - 90) * 0.01745);

      if (cursors.left.isDown)
        car.body.angularVelocity = -10 * (velocity / 1000);
      else if (cursors.right.isDown)
        car.body.angularVelocity = 10 * (velocity / 1000);
      else
        car.body.angularVelocity = 0;

        console.log("speed = ", velocity);
    }
  </script>

</body>

</html>
